webpackJsonp([20],{1827:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"CoreSettingsSynchronizationPageModule",function(){return f});var n=i(0),o=i(3),s=i(2),r=i(1946),c=i(16),a=i(15),l=i(75),d=this&&this.__decorate||function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},f=function(){function e(){}return e=d([Object(n.I)({declarations:[r.a],imports:[c.a,a.a,l.a,o.l.forChild(r.a),s.b.forChild()]})],e)}()},1946:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(0),o=i(29),s=i(12),r=i(4),c=i(9),a=i(102),l=i(890),d=this&&this.__decorate||function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},f=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(e,t,i,n,o){var r=this;this.configProvider=e,this.eventsProvider=t,this.sitesProvider=i,this.domUtils=n,this.settingsHelper=o,this.sites=[],this.sitesLoaded=!1,this.currentSiteId="",this.syncOnlyOnWifi=!1,this.isDestroyed=!1,this.currentSiteId=this.sitesProvider.getCurrentSiteId(),this.sitesObserver=this.eventsProvider.on(s.a.SITE_UPDATED,function(e){r.sitesProvider.getSite(e.siteId).then(function(e){var t=e.getInfo(),i=r.sites.find(function(t){return t.id==e.id});i&&(i.siteUrl=t.siteurl,i.siteName=t.sitename,i.fullName=t.fullname)})})}return e.prototype.ionViewDidLoad=function(){var e=this;this.sitesProvider.getSortedSites().then(function(t){e.sites=t}).finally(function(){e.sitesLoaded=!0}),this.configProvider.get(o.a.SETTINGS_SYNC_ONLY_ON_WIFI,!0).then(function(t){e.syncOnlyOnWifi=t})},e.prototype.syncOnlyOnWifiChanged=function(){this.configProvider.set(o.a.SETTINGS_SYNC_ONLY_ON_WIFI,this.syncOnlyOnWifi)},e.prototype.synchronize=function(e){var t=this;this.settingsHelper.synchronizeSite(this.syncOnlyOnWifi,e).catch(function(e){t.isDestroyed||t.domUtils.showErrorModalDefault(e,"core.settings.errorsyncsite",!0)})},e.prototype.isSynchronizing=function(e){return!!this.settingsHelper.getSiteSyncPromise(e)},e.prototype.ngOnDestroy=function(){this.isDestroyed=!0,this.sitesObserver&&this.sitesObserver.off()},e=d([Object(n.m)({selector:"page-core-settings-synchronization",template:'<ion-header>\n    <ion-navbar>\n        <ion-title>{{ \'core.settings.synchronization\' | translate }}</ion-title>\n    </ion-navbar>\n</ion-header>\n<ion-content>\n    <core-loading [hideUntil]="sitesLoaded">\n        <ion-item-divider color="light">\n            <p>{{ \'core.settings.syncsettings\' | translate }}</p>\n        </ion-item-divider>\n        <ion-item>\n            <ion-label>{{ \'core.settings.enablesyncwifi\' | translate }}</ion-label>\n            <ion-toggle item-end [(ngModel)]="syncOnlyOnWifi" (ngModelChange)="syncOnlyOnWifiChanged()">\n            </ion-toggle>\n        </ion-item>\n        <ion-item-divider color="light">\n            <p>{{ \'core.settings.sites\' | translate }}</p>\n        </ion-item-divider>\n        <ion-item *ngFor="let site of sites" [class.core-primary-item]="site.id == currentSiteId">\n            <h2><core-format-text [text]="site.siteName"></core-format-text></h2>\n            <p>{{ site.fullName }}</p>\n            <p>{{ site.siteUrl }}</p>\n            <button ion-button icon-only clear item-end *ngIf="!isSynchronizing(site.id)" (click)="synchronize(site.id)" [title]="site.siteName" [attr.aria-label]="\'core.settings.synchronizenow\' | translate">\n                <ion-icon name="sync"></ion-icon>\n            </button>\n            <ion-spinner item-end *ngIf="isSynchronizing(site.id)"></ion-spinner>\n        </ion-item>\n    </core-loading>\n</ion-content>\n'}),f("design:paramtypes",[a.a,s.a,r.a,c.a,l.a])],e)}()}});