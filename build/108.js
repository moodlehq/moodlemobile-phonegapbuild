webpackJsonp([108],{1729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"AddonBadgesUserBadgesPageModule",function(){return l});var a=n(0),r=n(3),o=n(2),i=n(16),s=n(15),d=n(75),c=n(1845),g=this&&this.__decorate||function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},l=function(){function e(){}return e=g([Object(a.I)({declarations:[c.a],imports:[i.a,s.a,d.a,r.l.forChild(c.a),o.b.forChild()]})],e)}()},1845:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(0),r=n(3),o=n(184),i=n(22),s=n(9),d=n(4),c=n(127),g=this&&this.__decorate||function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(){function e(e,t,n,a,r){this.badgesProvider=n,this.domUtils=a,this.timeUtils=r,this.badgesLoaded=!1,this.badges=[],this.currentTime=0,this.courseId=e.get("courseId")||0,this.userId=e.get("userId")||t.getCurrentSite().getUserId()}return e.prototype.ionViewDidLoad=function(){var e=this;this.fetchBadges().finally(function(){!e.badgeHash&&e.splitviewCtrl.isOn()&&e.badges.length>0&&e.loadIssuedBadge(e.badges[0].uniquehash),e.badgesLoaded=!0})},e.prototype.fetchBadges=function(){var e=this;return this.currentTime=this.timeUtils.timestamp(),this.badgesProvider.getUserBadges(this.courseId,this.userId).then(function(t){e.badges=t}).catch(function(t){e.domUtils.showErrorModalDefault(t,"Error getting badges data.")})},e.prototype.refreshBadges=function(e){var t=this;this.badgesProvider.invalidateUserBadges(this.courseId,this.userId).finally(function(){t.fetchBadges().finally(function(){e.complete()})})},e.prototype.loadIssuedBadge=function(e){this.badgeHash=e;this.splitviewCtrl.push("AddonBadgesIssuedBadgePage",{courseId:this.courseId,userId:this.userId,badgeHash:e})},g([Object(a._9)(r.f),l("design:type",r.f)],e.prototype,"content",void 0),g([Object(a._9)(c.a),l("design:type",c.a)],e.prototype,"splitviewCtrl",void 0),e=g([Object(a.m)({selector:"page-addon-badges-user-badges",template:'<ion-header>\n    <ion-navbar>\n        <ion-title>{{ \'addon.badges.badges\' | translate }}</ion-title>\n    </ion-navbar>\n</ion-header>\n<core-split-view>\n    <ion-content>\n        <ion-refresher [enabled]="badgesLoaded" (ionRefresh)="refreshBadges($event)">\n            <ion-refresher-content pullingText="{{ \'core.pulltorefresh\' | translate }}"></ion-refresher-content>\n        </ion-refresher>\n        <core-loading [hideUntil]="badgesLoaded">\n            <core-empty-box *ngIf="!badges || badges.length == 0" icon="trophy" [message]="\'addon.badges.nobadges\' | translate">\n            </core-empty-box>\n\n            <ion-list *ngIf="badges && badges.length" no-margin>\n                <a ion-item text-wrap *ngFor="let badge of badges" [title]="badge.name" (click)="loadIssuedBadge(badge.uniquehash)" [class.core-split-item-selected]="badge.uniquehash == badgeHash">\n                    <ion-avatar item-start>\n                        <img [src]="badge.badgeurl" [alt]="badge.name" item-start core-external-content>\n                    </ion-avatar>\n                    <h2><core-format-text [text]="badge.name"></core-format-text></h2>\n                    <p>{{ badge.dateissued | coreToLocaleString }}</p>\n                    <ion-badge item-end color="danger" *ngIf="badge.dateexpire && currentTime >= badge.dateexpire">\n                        {{ \'addon.badges.expired\' | translate }}\n                    </ion-badge>\n                </a>\n            </ion-list>\n        </core-loading>\n    </ion-content>\n</core-split-view>'}),l("design:paramtypes",[r.r,d.a,o.a,s.a,i.a])],e)}()}});