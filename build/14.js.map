{"version":3,"sources":["../../src/core/tag/pages/search/search.module.ts","../../src/core/tag/pages/search/search.ts"],"names":[],"mappings":"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","file":"14.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreTagSearchPage } from './search';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\n\n@NgModule({\n    declarations: [\n        CoreTagSearchPage\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        IonicPageModule.forChild(CoreTagSearchPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class CoreTagSerchPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/tag/pages/search/search.module.ts","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component } from '@angular/core';\nimport { IonicPage, NavParams, NavController } from 'ionic-angular';\nimport { TranslateService } from '@ngx-translate/core';\nimport { CoreAppProvider } from '@providers/app';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreUtilsProvider } from '@providers/utils/utils';\nimport { CoreTextUtilsProvider } from '@providers/utils/text';\nimport { CoreContentLinksHelperProvider } from '@core/contentlinks/providers/helper';\nimport { CoreTagProvider, CoreTagCloud, CoreTagCollection, CoreTagCloudTag } from '@core/tag/providers/tag';\n\n/**\n * Page that displays most used tags and allows searching.\n */\n@IonicPage({ segment: 'core-tag-search' })\n@Component({\n    selector: 'page-core-tag-search',\n    templateUrl: 'search.html',\n})\nexport class CoreTagSearchPage {\n    collectionId: number;\n    query: string;\n    collections: CoreTagCollection[] = [];\n    cloud: CoreTagCloud;\n    loaded = false;\n    searching = false;\n\n    constructor(private navCtrl: NavController, navParams: NavParams, private appProvider: CoreAppProvider,\n            private translate: TranslateService, private domUtils: CoreDomUtilsProvider, private utils: CoreUtilsProvider,\n            private textUtils: CoreTextUtilsProvider, private contentLinksHelper: CoreContentLinksHelperProvider,\n            private tagProvider: CoreTagProvider) {\n        this.collectionId = navParams.get('collectionId') || 0;\n        this.query = navParams.get('query') || '';\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.fetchData().finally(() => {\n            this.loaded = true;\n        });\n    }\n\n    fetchData(): Promise<any> {\n        return Promise.all([\n            this.fetchCollections(),\n            this.fetchTags()\n        ]).catch((error) => {\n            this.domUtils.showErrorModalDefault(error, 'Error loading tags.');\n        });\n    }\n\n    /**\n     * Fetch tag collections.\n     *\n     * @return Resolved when done.\n     */\n    fetchCollections(): Promise<any> {\n        return this.tagProvider.getTagCollections().then((collections) => {\n            collections.forEach((collection) => {\n                if (!collection.name && collection.isdefault) {\n                    collection.name = this.translate.instant('core.tag.defautltagcoll');\n                }\n            });\n            this.collections = collections;\n        });\n    }\n\n    /**\n     * Fetch tags.\n     *\n     * @return Resolved when done.\n     */\n    fetchTags(): Promise<any> {\n        return this.tagProvider.getTagCloud(this.collectionId, undefined, undefined, this.query).then((cloud) => {\n            this.cloud = cloud;\n        });\n    }\n\n    /**\n     * Go to tag index page.\n     */\n    openTag(tag: CoreTagCloudTag): void {\n        const url = this.textUtils.decodeURI(tag.viewurl);\n        this.contentLinksHelper.handleLink(url, undefined, this.navCtrl);\n    }\n\n    /**\n     * Refresh data.\n     *\n     * @param refresher Refresher.\n     */\n    refreshData(refresher: any): void {\n        this.utils.allPromises([\n            this.tagProvider.invalidateTagCollections(),\n            this.tagProvider.invalidateTagCloud(this.collectionId, undefined, undefined, this.query),\n        ]).finally(() => {\n            return this.fetchData().finally(() => {\n                refresher.complete();\n            });\n        });\n    }\n\n    /**\n     * Search tags.\n     *\n     * @param query Search query.\n     * @return Resolved when done.\n     */\n    searchTags(query: string): Promise<any> {\n        this.searching = true;\n        this.query = query;\n        this.appProvider.closeKeyboard();\n\n        return this.fetchTags().catch((error) => {\n            this.domUtils.showErrorModalDefault(error, 'Error loading tags.');\n        }).finally(() => {\n            this.searching = false;\n        });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/tag/pages/search/search.ts"],"sourceRoot":""}