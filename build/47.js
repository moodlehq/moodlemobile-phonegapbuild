webpackJsonp([47],{1800:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"CoreCoursesCategoriesPageModule",function(){return l});var o=r(0),n=r(3),i=r(2),c=r(1919),s=r(16),a=r(15),u=r(879),d=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,r,c):n(t,r))||c);return i>3&&c&&Object.defineProperty(t,r,c),c},l=function(){function e(){}return e=d([Object(o.I)({declarations:[c.a],imports:[s.a,u.a,a.a,n.l.forChild(c.a),i.b.forChild()]})],e)}()},1919:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var o=r(0),n=r(3),i=r(2),c=r(4),s=r(9),a=r(7),u=r(42),d=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,r,c):n(t,r))||c);return i>3&&c&&Object.defineProperty(t,r,c),c},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(){function e(e,t,r,o,n,i,c){this.navCtrl=e,this.coursesProvider=r,this.domUtils=o,this.utils=n,this.sitesProvider=c,this.categories=[],this.courses=[],this.categoryId=t.get("categoryId")||0,this.title=i.instant("core.courses.categories")}return e.prototype.ionViewDidLoad=function(){var e=this;this.fetchCategories().finally(function(){e.categoriesLoaded=!0})},e.prototype.fetchCategories=function(){var e=this;return this.coursesProvider.getCategories(this.categoryId,!0).then(function(t){if(e.currentCategory=void 0,t.forEach(function(r,o){r.id==e.categoryId&&(e.currentCategory=r,delete t[o])}),t.sort(function(e,t){return e.depth==t.depth?e.sortorder>t.sortorder?1:t.sortorder>e.sortorder?-1:0:e.depth>t.depth?1:-1}),e.categories=e.utils.formatTree(t,"parent","id",e.categoryId),e.currentCategory)return e.title=e.currentCategory.name,e.coursesProvider.getCoursesByField("category",e.categoryId).then(function(t){e.courses=t}).catch(function(t){e.domUtils.showErrorModalDefault(t,"core.courses.errorloadcourses",!0)})}).catch(function(t){e.domUtils.showErrorModalDefault(t,"core.courses.errorloadcategories",!0)})},e.prototype.refreshCategories=function(e){var t=this,r=[];r.push(this.coursesProvider.invalidateUserCourses()),r.push(this.coursesProvider.invalidateCategories(this.categoryId,!0)),r.push(this.coursesProvider.invalidateCoursesByField("category",this.categoryId)),r.push(this.sitesProvider.getCurrentSite().invalidateConfig()),Promise.all(r).finally(function(){t.fetchCategories().finally(function(){e.complete()})})},e.prototype.openCategory=function(e){this.navCtrl.push("CoreCoursesCategoriesPage",{categoryId:e})},e=d([Object(o.m)({selector:"page-core-courses-categories",template:'<ion-header>\n    <ion-navbar>\n        <ion-title><core-format-text [text]="title"></core-format-text></ion-title>\n    </ion-navbar>\n</ion-header>\n<ion-content>\n    <ion-refresher [enabled]="categoriesLoaded" (ionRefresh)="refreshCategories($event)">\n        <ion-refresher-content pullingText="{{ \'core.pulltorefresh\' | translate }}"></ion-refresher-content>\n    </ion-refresher>\n    <core-loading [hideUntil]="categoriesLoaded">\n        <ion-item *ngIf="currentCategory" text-wrap>\n            <ion-icon name="folder" item-start></ion-icon>\n            <h2><core-format-text [text]="currentCategory.name"></core-format-text></h2>\n        </ion-item>\n        <ion-item text-wrap *ngIf="currentCategory && currentCategory.description">\n            <core-format-text [text]="currentCategory.description" maxHeight="60"></core-format-text>\n        </ion-item>\n\n        <div *ngIf="categories.length > 0">\n            <ion-item-divider color="light">{{ \'core.courses.categories\' | translate }}</ion-item-divider>\n            <section *ngFor="let category of categories">\n                <a ion-item text-wrap (click)="openCategory(category.id)" [title]="category.name">\n                    <ion-icon name="folder" item-start></ion-icon>\n                    <h2><core-format-text [text]="category.name"></core-format-text></h2>\n                    <ion-badge item-end *ngIf="category.coursecount > 0" color="light">{{category.coursecount}}</ion-badge>\n                </a>\n            </section>\n        </div>\n\n        <div *ngIf="courses.length > 0">\n            <ion-item-divider color="light">{{ \'core.courses.courses\' | translate }}</ion-item-divider>\n            <core-courses-course-list-item *ngFor="let course of courses" [course]="course"></core-courses-course-list-item>\n        </div>\n        <core-empty-box *ngIf="!categories.length && !courses.length" icon="ionic" [message]="\'core.courses.nocoursesyet\' | translate">\n            <p *ngIf="searchEnabled">{{ \'core.courses.searchcoursesadvice\' | translate }}</p>\n        </core-empty-box>\n    </core-loading>\n</ion-content>\n'}),l("design:paramtypes",[n.q,n.r,u.a,s.a,a.a,i.c,c.a])],e)}()}});