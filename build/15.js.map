{"version":3,"sources":["../../src/core/tag/pages/index/index.module.ts","../../src/core/tag/pages/index/index.ts"],"names":[],"mappings":"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","file":"15.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreTagIndexPage } from './index';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\n\n@NgModule({\n    declarations: [\n        CoreTagIndexPage\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        IonicPageModule.forChild(CoreTagIndexPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class CoreTagIndexPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/tag/pages/index/index.module.ts","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavParams } from 'ionic-angular';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\nimport { CoreTagProvider } from '@core/tag/providers/tag';\nimport { CoreTagAreaDelegate } from '@core/tag/providers/area-delegate';\n\n/**\n * Page that displays the tag index.\n */\n@IonicPage({ segment: 'core-tag-index' })\n@Component({\n    selector: 'page-core-tag-index',\n    templateUrl: 'index.html',\n})\nexport class CoreTagIndexPage {\n    @ViewChild(CoreSplitViewComponent) splitviewCtrl: CoreSplitViewComponent;\n\n    tagId: number;\n    tagName: string;\n    collectionId: number;\n    areaId: number;\n    fromContextId: number;\n    contextId: number;\n    recursive: boolean;\n    loaded = false;\n    areas: Array<{\n        id: number,\n        componentName: string,\n        itemType: string,\n        nameKey: string,\n        items: any[],\n        canLoadMore: boolean,\n        badge: string\n    }>;\n    selectedAreaId: number;\n    hasUnsupportedAreas = false;\n\n    constructor(navParams: NavParams, private tagProvider: CoreTagProvider, private domUtils: CoreDomUtilsProvider,\n            private tagAreaDelegate: CoreTagAreaDelegate) {\n        this.tagId = navParams.get('tagId') || 0;\n        this.tagName = navParams.get('tagName') || '';\n        this.collectionId = navParams.get('collectionId');\n        this.areaId = navParams.get('areaId') || 0;\n        this.fromContextId = navParams.get('fromContextId') || 0;\n        this.contextId = navParams.get('contextId') || 0;\n        this.recursive = navParams.get('recursive') || true;\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.fetchData().then(() => {\n            if (this.splitviewCtrl.isOn() && this.areas && this.areas.length > 0) {\n                const area = this.areas.find((area) => area.id == this.areaId);\n                this.openArea(area || this.areas[0]);\n            }\n        }).finally(() => {\n            this.loaded = true;\n        });\n    }\n\n    /**\n     * Fetch first page of tag index per area.\n     *\n     * @return Resolved when done.\n     */\n    fetchData(): Promise<any> {\n        return this.tagProvider.getTagIndexPerArea(this.tagId, this.tagName, this.collectionId, this.areaId, this.fromContextId,\n                this.contextId, this.recursive, 0).then((areas) => {\n            this.areas = [];\n            this.hasUnsupportedAreas = false;\n\n            return Promise.all(areas.map((area) => {\n                return this.tagAreaDelegate.parseContent(area.component, area.itemtype, area.content).then((items) => {\n                    if (!items || !items.length) {\n                        // Tag area not supported, skip.\n                        this.hasUnsupportedAreas = true;\n\n                        return null;\n                    }\n\n                    return {\n                        id: area.ta,\n                        componentName: area.component,\n                        itemType: area.itemtype,\n                        nameKey: this.tagAreaDelegate.getDisplayNameKey(area.component, area.itemtype),\n                        items,\n                        canLoadMore: !!area.nextpageurl,\n                        badge: items && items.length ? items.length + (area.nextpageurl ? '+' : '') : '',\n                    };\n                });\n            })).then((areas) => {\n                this.areas = areas.filter((area) => area != null);\n            });\n        }).catch((error) => {\n            this.domUtils.showErrorModalDefault(error, 'Error loading tag index');\n        });\n    }\n\n    /**\n     * Refresh data.\n     *\n     * @param refresher Refresher.\n     */\n    refreshData(refresher: any): void {\n        this.tagProvider.invalidateTagIndexPerArea(this.tagId, this.tagName, this.collectionId, this.areaId, this.fromContextId,\n                this.contextId, this.recursive).finally(() => {\n            this.fetchData().finally(() => {\n                refresher.complete();\n            });\n        });\n    }\n\n    /**\n     * Navigate to an index area.\n     *\n     * @param area Area.\n     */\n    openArea(area: any): void {\n        this.selectedAreaId = area.id;\n        const params = {\n            tagId: this.tagId,\n            tagName: this.tagName,\n            collectionId: this.collectionId,\n            areaId: area.id,\n            fromContextId: this.fromContextId,\n            contextId: this.contextId,\n            recursive: this.recursive,\n            areaNameKey: area.nameKey,\n            componentName: area.component,\n            itemType: area.itemType,\n            items: area.items.slice(),\n            canLoadMore: area.canLoadMore,\n            nextPage: 1\n        };\n        this.splitviewCtrl.push('CoreTagIndexAreaPage', params);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/tag/pages/index/index.ts"],"sourceRoot":""}